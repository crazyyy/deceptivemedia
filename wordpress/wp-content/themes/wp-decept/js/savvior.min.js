!function(t,e){"function"==typeof define&&define.amd?define("savvior",["enquire"],function(n){return t["new GridDispatch()"]=e(n)}):"object"==typeof exports?module.exports=e(require("enquire.js")):t.savvior=e(t.enquire)}(this,function(t){function e(t,e,n,i){i||!t.dataset?t.setAttribute("data-"+e,n):t.dataset[e]=n}function n(t,e,n){var i=0;for(i;i<t.length&&!1!==e.call(n,t[i],i);i++);}function i(t){return"function"==typeof t}function o(t,e){for(e in t)return!1;return!0}function r(t,e){for(var n in t)e[n]=t[n];return e}"function"!=typeof window.CustomEvent&&function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}window.CustomEvent=t,t.prototype=window.CustomEvent.prototype}(),function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,n){var i=(new Date).getTime(),o=Math.max(0,16-(i-t)),r=window.setTimeout(function(){e(i+o)},o);return t=i+o,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var s=function(t){this.columns=null,this.element=t,this.filtered=document.createDocumentFragment(),this.status=!1,this.columnClasses=null};s.prototype.setup=function(t,n){if(this.status)return!1;var o=document.createRange(),r=document.createElement("div");o.selectNodeContents(this.element),r.appendChild(o.extractContents()),window.requestAnimationFrame(function(){e(r,"columns",0),this.addColumns(r,t),this.status=!0,i(n)&&n.call(this)}.bind(this))},s.prototype.addColumns=function(t,i){var o,r,s,u=i.columnClasses||["column","size-1of"+i.columns],a=document.createDocumentFragment(),l=[],c=i.columns;for(this.filterItems(t,i.filter),u=Array.isArray(u)?u.join(" "):u;0!=c--;)o="[data-columns] > *:nth-child("+i.columns+"n-"+c+")",l.push(t.querySelectorAll(o));n(l,function(t){r=document.createElement("div"),s=document.createDocumentFragment(),r.className=u,n(t,function(t){s.appendChild(t)}),r.appendChild(s),a.appendChild(r)}),this.element.appendChild(a),e(this.element,"columns",i.columns),this.columns=i.columns,this.columnClasses=i.columnClasses},s.prototype.filterItems=function(t,i){if(!i)return t;var o,r,s;return s=Array.prototype.slice.call(t.children),r=t.querySelectorAll("[data-columns] > "+i),n(r,function(t){o=s.indexOf(t),this.filtered.appendChild(t),e(t,"position",o)},this),t},s.prototype.removeColumns=function(){var t,i=document.createRange(),o=document.createElement("div"),r=[];return i.selectNodeContents(this.element),t=Array.prototype.filter.call(i.extractContents().childNodes,function(t){return t instanceof window.HTMLElement}),r.length=t[0].childNodes.length*t.length,n(t,function(e,i){n(e.children,function(e,n){r[n*t.length+i]=e})}),e(o,"columns",0),r.filter(function(t){return!!t}).forEach(function(t){o.appendChild(t)}),o},s.prototype.redraw=function(t,e){var n,o=new CustomEvent("savvior:redraw",{detail:{element:this.element,from:this.columns,to:t.columns,filter:t.filter||null}});window.requestAnimationFrame(function(){this.columns!==t.columns&&(n=this.restoreFiltered(this.removeColumns()),this.addColumns(n,t)),window.dispatchEvent(o),i(e)&&e(this)}.bind(this))},s.prototype.restoreFiltered=function(t){if(0===this.filtered.childNodes.length)return t;var e,i=t;return n(this.filtered.querySelectorAll("[data-position]"),function(t){e=Number(t.getAttribute("data-position")),t.removeAttribute("data-position"),i.insertBefore(t,i.children[e]||null)}),t},s.prototype.restore=function(t,e){if(!this.status)return i(t)&&t(!1),!1;var o,r=document.createDocumentFragment(),s=[],u=new CustomEvent("savvior:restore",{detail:{element:this.element,from:this.columns}});window.requestAnimationFrame(function(){n((o=this.restoreFiltered(this.removeColumns())).childNodes,function(t){s.push(t)}),s.forEach(function(t){r.appendChild(t)}),this.element.appendChild(r),this.element.removeAttribute("data-columns"),window.dispatchEvent(u),i(t)&&t.call(e,e||this)}.bind(this))},s.prototype.addItems=function(t,e,o){var r=new CustomEvent("savvior:addItems",{detail:{element:this.element,grid:this}}),s=function(t){return e.clone?t.cloneNode(!0):t},u={append:function(t,e){var n=s(t);return e.appendChild(n),e},prepend:function(t,e){var n=s(t);return e.insertBefore(n,e.firstChild),e}};window.requestAnimationFrame(function(){var s=this.restoreFiltered(this.removeColumns());t instanceof NodeList||t instanceof Array?n(t,function(t){s=u[e.method].call(null,t,s)}):s=u[e.method].call(null,t,s),this.addColumns(s,{columns:this.columns,columnClasses:this.columnClasses,filter:this.filter}),window.dispatchEvent(r),i(o)&&o(this)}.bind(this))};var u=function(t,e){this.selector=t,this.options=e,this.queryHandlers=[],this.grids=[],this.ready=!1};u.prototype.register=function(){n(document.querySelectorAll(this.selector),function(t){this.grids.push(new s(t,this.options))},this);for(var e in this.options)this.queryHandlers.push(this.constructHandler(e,this.options[e]));return n(this.queryHandlers,function(e){t.register(e.mq,e.handler)}),this.ready=!0,this},u.prototype.constructHandler=function(t){return{mq:t,handler:{deferSetup:!0,setup:function(){this.gridSetup(t)}.bind(this),match:function(){this.gridMatch(t)}.bind(this),destroy:function(){}}}},u.prototype.gridSetup=function(t){var e;n(this.grids,function(n){n.setup(this.options[t],function(){e=new CustomEvent("savvior:setup",{detail:{element:n.element,columns:n.columns,filter:this.filter}}),window.dispatchEvent(e)})},this)},u.prototype.gridMatch=function(t){var e;n(this.grids,function(n){e=new CustomEvent("savvior:match",{detail:{element:n.element,from:n.columns,to:this.options[t].columns,query:t}}),n.redraw(this.options[t],function(){window.dispatchEvent(e)})},this)},u.prototype.unregister=function(e,o){n(this.queryHandlers,function(e){t.unregister(e.mq)}),n(this.grids,function(t){t.restore(function(){this.queryHandlers=[],this.ready=!1,i(e)&&e.call(this,o||this)},this)},this),this.grids=[]};var a=function(){if(!t)throw new Error("enquire.js not present, please load it before calling any methods");this.grids={}};return a.prototype.init=function(t,e){if(!t)throw new TypeError("Missing selector");if("string"!=typeof t)throw new TypeError("Selector must be a string");if("object"!=typeof e)throw new TypeError("Options must be an object");return this.grids[t]?this:document.querySelectorAll(t).length<1?this:(this.grids[t]=new u(t,e),this.grids[t].register(e),window.dispatchEvent(new CustomEvent("savvior:init")),this)},a.prototype.destroy=function(t,e){var r=new CustomEvent("savvior:destroy",{detail:{selectors:t}}),s=void 0===t||o(t)?Object.keys(this.grids):t,u=s.length,a=0,l=function(t){delete this.grids[s[a]],++a===u&&(window.dispatchEvent(r),i(e)&&e.call(t,this))}.bind(this);n(s,function(t){this.grids[t]&&this.grids[t].unregister(l)},this)},a.prototype.ready=function(t){if(void 0===t){var e=[];for(var n in this.grids)this.grids[n].ready&&e.push(n);return e.length>0&&e}return!!this.grids[t]&&this.grids[t].ready},a.prototype.addItems=function(t,e,o,s){var u,a,l={clone:!1,method:"append"};if(!this.grids[t])throw new TypeError("Grid does not exist.");if("string"==typeof e&&(e=document.querySelectorAll(e)),e instanceof Array)n(e,function(t){if(!(t instanceof Node))throw new TypeError("Supplied element in array is not instance of Node.")},this);else if(!(e instanceof Node||e instanceof NodeList))throw new TypeError("Supplied argument is not a Node or a NodeList.");return i(o)?(u=o,a=l):(u=s,a=r(o,l)),n(this.grids[t].grids,function(t){t.addItems(e,a,u)}),this},new a});
//# sourceMappingURL=maps/savvior.min.js.map
